<!<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Safety Huddle Local</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 15px;
      max-width: 900px;
      margin: auto;
      background: #f7f7f7;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
    }
    .top label {
      margin-right: 20px;
      font-weight: bold;
    }
    .checkbox-group label {
      margin-right: 15px;
      display: inline-block;
      margin-bottom: 8px;
    }
    .info label {
      display: inline-block;
      margin-right: 20px;
      margin-bottom: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background: #fff;
    }
    th, td {
      border: 1px solid #bbb;
      padding: 7px;
      text-align: left;
      vertical-align: middle;
    }
    th {
      background-color: #ddd;
    }
    input[type="text"], input[type="number"], input[type="date"] {
      width: 95%;
      padding: 4px;
      box-sizing: border-box;
    }
    input[type="radio"] {
      transform: scale(1.2);
      margin: 0 6px;
      vertical-align: middle;
    }
    .rodape {
      font-size: 0.85em;
      margin-top: 20px;
      color: #444;
    }
    #btnSavePdf {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 1em;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Safety Huddle Local</h2>
    <div class="top">
      <label>Data: <input type="date" id="date" /></label>
      <label>Tempo Gasto: <input type="number" min="0" id="timeSpent" /> min</label>
    </div>

    <div class="checkbox-group">
      <strong>Equipe do Huddle:</strong><br />
      <label><input type="checkbox" id="equipeEnfermeiros" /> Enfermeiros</label>
      <label><input type="checkbox" id="equipeFisioterapeuta" /> Fisioterapeuta</label>
      <label><input type="checkbox" id="equipeNutricionistas" /> Nutricionistas</label>
      <label><input type="checkbox" id="equipeTecnicos" /> Técnicos</label>
      <label><input type="checkbox" id="equipeAuxiliares" /> Auxiliares</label>
    </div>

    <div class="info">
      <label>Número de Leitos Ocupados: <input type="text" id="leitosOcupados" /></label>
      <label>Previsões de Alta: <input type="text" id="previsoesAlta" /></label>
      <label>Leitos interditados: <input type="text" id="leitosInterditados" /></label>
      <label>Contingência/leitos extras: <input type="text" id="contingenciaLeitosExtras" /></label>
    </div>

    <table>
      <thead>
        <tr>
          <th style="width: 30%">Pergunta</th>
          <th>Não</th>
          <th>Sim</th>
          <th>Quais?</th>
          <th>Devolutiva do caso para a equipe</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1. Paciente com gerenciamento de risco (farol vermelho ou amarelo)?</td>
          <td><input type="radio" name="q1" value="não" /></td>
          <td><input type="radio" name="q1" value="sim" /></td>
          <td><input type="text" id="q1_quais" /></td>
          <td><input type="text" id="q1_devolutiva" /></td>
        </tr>
        <tr>
          <td>2. Paciente watcher (seriamente preocupado, críticos ou instáveis)?</td>
          <td><input type="radio" name="q2" value="não" /></td>
          <td><input type="radio" name="q2" value="sim" /></td>
          <td><input type="text" id="q2_quais" /></td>
          <td><input type="text" id="q2_devolutiva" /></td>
        </tr>
        <tr>
          <td>3. Paciente com alto risco de queda, resistente à orientações e não aderente às medidas preventivas ou sem acompanhante? Polifarmácia? Farmacêutico ciente?</td>
          <td><input type="radio" name="q3" value="não" /></td>
          <td><input type="radio" name="q3" value="sim" /></td>
          <td><input type="text" id="q3_quais" /></td>
          <td><input type="text" id="q3_devolutiva" /></td>
        </tr>
        <tr>
          <td>4. Pacientes com alto risco de LP? Resistente às medidas preventivas?</td>
          <td><input type="radio" name="q4" value="não" /></td>
          <td><input type="radio" name="q4" value="sim" /></td>
          <td><input type="text" id="q4_quais" /></td>
          <td><input type="text" id="q4_devolutiva" /></td>
        </tr>
        <tr>
          <td>5. Divergências entre o plano terapêutico?</td>
          <td><input type="radio" name="q5" value="não" /></td>
          <td><input type="radio" name="q5" value="sim" /></td>
          <td><input type="text" id="q5_quais" /></td>
          <td><input type="text" id="q5_devolutiva" /></td>
        </tr>
        <tr>
          <td>6. Terapias, procedimentos, protocolos ou dispositivos de alto risco ou não habituais? (LP3 ou acima, Flebite grau 3 ou acima, erro de medicações, Quedas, ICS)</td>
          <td><input type="radio" name="q6" value="não" /></td>
          <td><input type="radio" name="q6" value="sim" /></td>
          <td><input type="text" id="q6_quais" /></td>
          <td><input type="text" id="q6_devolutiva" /></td>
        </tr>
        <tr>
          <td>7. Houve a ocorrência de procedimentos invasivos não planejados ou situações de emergências?</td>
          <td><input type="radio" name="q7" value="não" /></td>
          <td><input type="radio" name="q7" value="sim" /></td>
          <td><input type="text" id="q7_quais" /></td>
          <td><input type="text" id="q7_devolutiva" /></td>
        </tr>
        <tr>
          <td>8. Eventos Adversos?</td>
          <td><input type="radio" name="q8" value="não" /></td>
          <td><input type="radio" name="q8" value="sim" /></td>
          <td><input type="text" id="q8_quais" /></td>
          <td><input type="text" id="q8_devolutiva" /></td>
        </tr>
        <tr>
          <td>9. Problemas com infraestrutura, Cerner, equipamentos, materiais ou medicamentos?</td>
          <td><input type="radio" name="q9" value="não" /></td>
          <td><input type="radio" name="q9" value="sim" /></td>
          <td><input type="text" id="q9_quais" /></td>
          <td><input type="text" id="q9_devolutiva" /></td>
        </tr>
        <tr>
          <td>10. Algum paciente elegível para a visita multiprofissional ou discussão do time diagnóstico?</td>
          <td><input type="radio" name="q10" value="não" /></td>
          <td><input type="radio" name="q10" value="sim" /></td>
          <td><input type="text" id="q10_quais" /></td>
          <td><input type="text" id="q10_devolutiva" /></td>
        </tr>
        <tr>
          <td>11. Outros:</td>
          <td><input type="radio" name="q11" value="não" /></td>
          <td><input type="radio" name="q11" value="sim" /></td>
          <td><input type="text" id="q11_quais" /></td>
          <td><input type="text" id="q11_devolutiva" /></td>
        </tr>
      </tbody>
    </table>

    <p class="rodape">
      *Fluxo de Escalonamento: Horário comercial comunicar sênior e Coordenador. Período noturno comunicar sênior e/ou supervisor administrativo. Nos finais de semana comunicar coordenador da área, não conseguindo contato acionar direto supervisor administrativo.
    </p>

    <button id="btnSavePdf">Gerar PDF</button>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    // Config Firebase - Substitua pelas suas configs do projeto
    const firebaseConfig = {
      apiKey: "SUA_API_KEY",
      authDomain: "SEU_AUTH_DOMAIN",
      databaseURL: "SUA_DATABASE_URL",
      projectId: "SEU_PROJECT_ID",
      storageBucket: "SEU_STORAGE_BUCKET",
      messagingSenderId: "SEU_MESSAGING_SENDER_ID",
      appId: "SEU_APP_ID"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const storagePath = "safety-huddle";

    // Função para salvar dados no Firebase
    function salvarDados() {
      const data = document.getElementById("date").value || "";
      const tempo = document.getElementById("timeSpent").value || "";

      const equipe = {
        enfermeiros: document.getElementById("equipeEnfermeiros").checked,
        fisioterapeuta: document.getElementById("equipeFisioterapeuta").checked,
        nutricionistas: document.getElementById("equipeNutricionistas").checked,
        tecnicos: document.getElementById("equipeTecnicos").checked,
        auxiliares: document.getElementById("equipeAuxiliares").checked,
      };

      const info = {
        leitosOcupados: document.getElementById("leitosOcupados").value || "",
        previsoesAlta: document.getElementById("previsoesAlta").value || "",
        leitosInterditados: document.getElementById("leitosInterditados").value || "",
        contingenciaLeitosExtras: document.getElementById("contingenciaLeitosExtras").value || "",
      };

      // Coletar respostas das perguntas
      const perguntas = {};
      for(let i=1; i<=11; i++) {
        const radios = document.getElementsByName("q"+i);
        let resposta = "";
        radios.forEach(radio => {
          if(radio.checked) resposta = radio.value;
        });
        perguntas["q"+i] = {
          resposta: resposta,
          quais: document.getElementById("q"+i+"_quais").value || "",
          devolutiva: document.getElementById("q"+i+"_devolutiva").value || ""
        };
      }

      const dados = {
        data,
        tempo,
        equipe,
        info,
        perguntas
      };

      db.ref(storagePath).set(dados);
    }

    // Função para carregar dados do Firebase e preencher o formulário
    function carregarDados() {
      db.ref(storagePath).once('value').then(snapshot => {
        const dados = snapshot.val();
        if (!dados) return;

        document.getElementById("date").value = dados.data || "";
        document.getElementById("timeSpentDOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Safety Huddle Local</title>
<style>
  body { font-family: Arial; margin: 20px; background: #f7f7f7; }
  .container { max-width: 900px; margin: auto; background: #fff; padding: 20px; border-radius: 5px; }
  h2 { text-align: center; }
  table { width: 100%; border-collapse: collapse; margin-top: 15px; }
  th, td { border: 1px solid #ccc; padding: 8px; font-size: 14px; }
  th { background: #4a90e2; color: white; }
  input[type="text"], input[type="date"], input[type="number"] { width: 100%; box-sizing: border-box; padding: 5px; }
  button { background: #4a90e2; color: white; border: none; padding: 10px 15px; cursor: pointer; border-radius: 4px; margin-top: 15px; }
  button:hover { background: #357ABD; }
</style>
<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
<div class="container" id="formContainer">
  <h2>Safety Huddle Local</h2>
  
  <label>Data: <input type="date" id="inputDate" /></label>
  <label>Tempo Gasto (min): <input type="number" min="0" id="inputTime" /></label>

  <div>
    <strong>Equipe do Huddle:</strong><br/>
    <label><input type="checkbox" class="team-member" value="Enfermeiros">Enfermeiros</label>
    <label><input type="checkbox" class="team-member" value="Fisioterapeuta">Fisioterapeuta</label>
    <label><input type="checkbox" class="team-member" value="Nutricionistas">Nutricionistas</label>
    <label><input type="checkbox" class="team-member" value="Técnicos">Técnicos</label>
    <label><input type="checkbox" class="team-member" value="Auxiliares">Auxiliares</label>
  </div>

  <label>Número de Leitos Ocupados: <input type="text" id="bedsOccupied" /></label>
  <label>Previsões de Alta: <input type="text" id="forecastDischarge" /></label>
  <label>Leitos interditados: <input type="text" id="blockedBeds" /></label>
  <label>Contingência/leitos extras: <input type="text" id="extraBeds" /></label>

  <table>
    <thead>
      <tr>
        <th>Pergunta</th>
        <th>Não</th>
        <th>Sim</th>
        <th>Quais?</th>
        <th>Devolutiva</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>1. Paciente com gerenciamento de risco (farol amarelo ou vermelho)?</td>
        <td><input type="radio" name="q1" value="Não"></td>
        <td><input type="radio" name="q1" value="Sim"></td>
        <td><input type="text" name="q1_quais"></td>
        <td><input type="text" name="q1_devolutiva"></td>
      </tr>
      <tr>
        <td>2. Paciente “Whatcher” (seriamente preocupado, críticos ou instáveis?)</td>
        <td><input type="radio" name="q2" value="Não"></td>
        <td><input type="radio" name="q2" value="Sim"></td>
        <td><input type="text" name="q2_quais"></td>
        <td><input type="text" name="q2_devolutiva"></td>
      </tr>
      <tr>
        <td>3. Pacientes com alto risco de queda, resistentes às orientações e não aderente às medidas preventivas ou sem acompanhante?</td>
        <td><input type="radio" name="q3" value="Não"></td>
        <td><input type="radio" name="q3" value="Sim"></td>
        <td><input type="text" name="q3_quais"></td>
        <td><input type="text" name="q3_devolutiva"></td>
      </tr>
      <tr>
        <td>4. Pacientes com alto risco LP? Resistente às medidas preventivas?</td>
        <td><input type="radio" name="q4" value="Não"></td>
        <td><input type="radio" name="q4" value="Sim"></td>
        <td><input type="text" name="q4_quais"></td>
        <td><input type="text" name="q4_devolutiva"></td>
      </tr>
      <tr>
        <td>5. Divergências entre o plano terapêutico?</td>
        <td><input type="radio" name="q5" value="Não"></td>
        <td><input type="radio" name="q5" value="Sim"></td>
        <td><input type="text" name="q5_quais"></td>
        <td><input type="text" name="q5_devolutiva"></td>
      </tr>
      <tr>
        <td>6. Terapias, procedimentos, protocolos ou dispositivos de alto risco ou não habituais?</td>
        <td><input type="radio" name="q6" value="Não"></td>
        <td><input type="radio" name="q6" value="Sim"></td>
        <td><input type="text" name="q6_quais"></td>
        <td><input type="text" name="q6_devolutiva"></td>
      </tr>
      <tr>
        <td>7. Houve a ocorrência de procedimentos invasivos não planejados ou situações de emergências?</td>
        <td><input type="radio" name="q7" value="Não"></td>
        <td><input type="radio" name="q7" value="Sim"></td>
        <td><input type="text" name="q7_quais"></td>
        <td><input type="text" name="q7_devolutiva"></td>
      </tr>
      <tr>
        <td>8. Eventos Adversos?</td>
        <td><input type="radio" name="q8" value="Não"></td>
        <td><input type="radio" name="q8" value="Sim"></td>
        <td><input type="text" name="q8_quais"></td>
        <td><input type="text" name="q8_devolutiva"></td>
      </tr>
      <tr>
        <td>9. Problemas com infraestrutura, Cerner, equipamentos, materiais ou medicamentos?</td>
        <td><input type="radio" name="q9" value="Não"></td>
        <td><input type="radio" name="q9" value="Sim"></td>
        <td><input type="text" name="q9_quais"></td>
        <td><input type="text" name="q9_devolutiva"></td>
      </tr>
      <tr>
        <td>10. Algum paciente elegível para a visita multiprofissional ou discussão do time diagnóstico?</td>
        <td><input type="radio" name="q10" value="Não"></td>
        <td><input type="radio" name="q10" value="Sim"></td>
        <td><input type="text" name="q10_quais"></td>
        <td><input type="text" name="q10_devolutiva"></td>
      </tr>
      <tr>
        <td>11. Outros:</td>
        <td><input type="radio" name="q11" value="Não"></td>
        <td><input type="radio" name="q11" value="Sim"></td>
        <td><input type="text" name="q11_quais"></td>
        <td><input type="text" name="q11_devolutiva"></td>
      </tr>
    </tbody>
  </table>
  
  <button id="btnSavePdf">Salvar PDF</button>
</div>

<script>
  const { jsPDF } = window.jspdf;

  document.getElementById('btnSavePdf').addEventListener('click', () => {
    const doc = new jsPDF('p', 'pt', 'a4');
    let y = 20;
    doc.setFontSize(18);
    doc.text('Safety Huddle Local', 40, y);
    y += 30;
    doc.setFontSize(12);

    function getInputValue(id) {
      const el = document.getElementById(id);
      return el ? el.value || '' : '';
    }

    function getCheckboxValues(className) {
      const checked = [...document.querySelectorAll(`.${className}:checked`)];
      return checked.map(chk => chk.value).join(', ');
    }

    doc.text(`Data: ${getInputValue('inputDate')}`, 40, y);
    y += 15;
    doc.text(`Tempo Gasto (min): ${getInputValue('inputTime')}`, 40, y);
    y += 15;
    doc.text(`Equipe do Huddle: ${getCheckboxValues('team-member')}`, 40, y);
    y += 15;
    doc.text(`Leitos Ocupados: ${getInputValue('bedsOccupied')}`, 40, y);
    y += 15;
    doc.text(`Previsões de Alta: ${getInputValue('forecastDischarge')}`, 40, y);
    y += 15;
    doc.text(`Leitos interditados: ${getInputValue('blockedBeds')}`, 40, y);
    y += 15;
    doc.text(`Contingência/leitos extras: ${getInputValue('extraBeds')}`, 40, y);
    y += 25;

    // Perguntas e respostas
    const perguntas = [];
    for (let i = 1; i <= 11; i++) {
      const qText = document.querySelector(`tbody tr:nth-child(${i}) td:first-child`).innerText.trim();
      const radios = document.getElementsByName('q'+i);
      let radioValue = '';
      radios.forEach(r => { if (r.checked) radioValue = r.value; });
      const quais = document.querySelector(`[name="q${i}_quais"]`).value.trim();
      const devolutiva = document.querySelector(`[name="q${i}_devolutiva"]`).value.trim();

      perguntas.push({ qText, radioValue, quais, devolutiva });
    }

    perguntas.forEach(p => {
      if (y > 760) {
        doc.addPage();
        y = 20;
      }
      doc.setFont(undefined, 'bold');
      doc.text(p.qText, 40, y);
      y += 15;
      doc.setFont(undefined, 'normal');
      doc.text(`Resposta: ${p.radioValue || 'Não respondido'}`, 50, y);
      y += 15;
      doc.text(`Quais? ${p.quais || '-'}`, 50, y);
      y += 15;
      doc.text(`Devolutiva: ${p.devolutiva || '-'}`, 50, y);
      y += 25;
    });

    doc.save('safety-huddle.pdf');
  });
</script>

</body>
</html>